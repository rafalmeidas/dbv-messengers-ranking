import{a as j,c as y,d as D,f as A}from"./chunk-ZZOBN54U.js";import{a as B,b as G,c as I,d as L,e as $,f as q,g as J,h as z}from"./chunk-DE3NCQEF.js";import{a as H}from"./chunk-K6XW2OCE.js";import{$ as S,F as d,I as U,P,R as o,S as a,Sa as f,T as W,U as N,V as g,X as T,Y as w,_ as C,aa as _,e as s,g as b,h as R,i as M,j as V,m as F,na as k,p as E,s as v,t as c,x as m,y as p}from"./chunk-GU5RU5RK.js";var h=class l{constructor(e,r){this.firestore=e;this.authService=r}role$=new b(null);setUserRole(e,r){return s(this,null,function*(){let t=y(this.firestore,`users/${r}`);yield A(t,{role:e},{merge:!0}),this.role$.next(e)})}getUserRole$(){return this.role$.pipe(F(e=>e?M(e):R(this.loadUserRole())))}loadUserRole(){return s(this,null,function*(){let e=yield V(this.authService.currentUser);if(!e)return"user";let r=y(this.firestore,`users/${e.uid}`),i=(yield D(r)).data()?.role??"user";return this.role$.next(i),i})}resetRole(){this.role$.next(null)}static \u0275fac=function(r){return new(r||l)(v(j),v(f))};static \u0275prov=E({token:l,factory:l.\u0275fac,providedIn:"root"})};var K=class l{email="";password="";authService=c(f);userService=c(h);router=c(k);register(){return s(this,null,function*(){let e=yield this.authService.register(this.email,this.password);this.saveCredentials(e)})}registerWithGoogle(){return s(this,null,function*(){let e=yield this.authService.loginWithGoogle();this.saveCredentials(e)})}saveCredentials(e){return s(this,null,function*(){e&&(yield this.userService.setUserRole("user",e.user.uid),this.router.navigateByUrl("/home"))})}navigateToLogin(){this.router.navigate(["/login"])}static \u0275fac=function(r){return new(r||l)};static \u0275cmp=U({type:l,selectors:[["app-register"]],decls:12,vars:3,consts:[["registerForm","ngForm"],[3,"ngSubmit"],["type","email","name","email","placeholder","Email","required","",3,"ngModelChange","ngModel"],["type","password","name","password","placeholder","Password","required","",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["variant","outline","label","Entrar com Google",3,"onClick"],["label","J\xE1 \xE9 cadastrado? Ir para Login",3,"onClick"]],template:function(r,t){if(r&1){let i=N();o(0,"h2"),w(1,"Register"),a(),o(2,"form",1,0),g("ngSubmit",function(){return m(i),p(t.register())}),o(4,"input",2),_("ngModelChange",function(n){return m(i),S(t.email,n)||(t.email=n),p(n)}),a(),o(5,"input",3),_("ngModelChange",function(n){return m(i),S(t.password,n)||(t.password=n),p(n)}),a(),o(6,"button",4),w(7,"Register"),a()(),o(8,"app-button",5),g("onClick",function(){return m(i),p(t.registerWithGoogle())}),a(),W(9,"br")(10,"br"),o(11,"app-button",6),g("onClick",function(){return m(i),p(t.navigateToLogin())}),a()}if(r&2){let i=T(3);d(4),C("ngModel",t.email),d(),C("ngModel",t.password),d(),P("disabled",i.invalid)}},dependencies:[z,q,B,G,I,J,$,L,H],encapsulation:2})};export{K as RegisterComponent};
