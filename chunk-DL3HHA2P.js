import{a as x,c as h,d as G,f as R}from"./chunk-RNAHQQNC.js";import{a as s,b as F,c as U,d as N,e as C,f as k,g as $,h as j,i as E,j as I}from"./chunk-B6JRJQKL.js";import{a as D}from"./chunk-UJPOMFMD.js";import{D as d,G as b,Ka as c,N as f,P as l,Q as m,R as S,S as p,e as o,fa as y,g as v,h as _,i as P,j as M,m as O,p as w,s as g,t as a}from"./chunk-YEFVGOSV.js";var u=class i{constructor(e,t){this.firestore=e;this.authService=t}role$=new v(null);setUserRole(e,t){return o(this,null,function*(){let r=h(this.firestore,`users/${t}`);yield R(r,{role:e},{merge:!0}),this.role$.next(e)})}getUserRole$(){return this.role$.pipe(O(e=>e?P(e):_(this.loadUserRole())))}loadUserRole(){return o(this,null,function*(){let e=yield M(this.authService.currentUser);if(!e)return"user";let t=h(this.firestore,`users/${e.uid}`),n=(yield G(t)).data()?.role??"user";return this.role$.next(n),n})}resetRole(){this.role$.next(null)}static \u0275fac=function(t){return new(t||i)(g(x),g(c))};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})};var T=class i{formGroup=new N({email:new C("",[s.required,s.email]),password:new C("",[s.required,s.minLength(5)])});authService=a(c);userService=a(u);router=a(y);get email(){return this.formGroup.get("email")?.value}get password(){return this.formGroup.get("password")?.value}register(){return o(this,null,function*(){let e=yield this.authService.register(this.email,this.password);this.saveCredentials(e)})}registerWithGoogle(){return o(this,null,function*(){let e=yield this.authService.loginWithGoogle();this.saveCredentials(e)})}saveCredentials(e){return o(this,null,function*(){e&&(yield this.userService.setUserRole("user",e.user.uid),this.router.navigateByUrl("/home"))})}navigateToLogin(){this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=b({type:i,selectors:[["app-register"]],decls:8,vars:2,consts:[[1,"register"],[3,"ngSubmit","formGroup"],["label","E-mail","formControlName","email","name","email","type","email","placeholder","Email"],["label","Senha","formControlName","password","name","password","type","password","placeholder","Senha"],["type","submit","label","Cadastrar",3,"disabled"],["variant","outline","label","Cadastre-se com Google",3,"onClick"],["label","J\xE1 \xE9 cadastrado? Ir para Login",3,"onClick"]],template:function(t,r){t&1&&(l(0,"section",0)(1,"form",1),p("ngSubmit",function(){return r.register()}),S(2,"app-input",2)(3,"app-input",3)(4,"app-button",4),m(),l(5,"article")(6,"app-button",5),p("onClick",function(){return r.registerWithGoogle()}),m(),l(7,"app-button",6),p("onClick",function(){return r.navigateToLogin()}),m()()()),t&2&&(d(),f("formGroup",r.formGroup),d(3),f("disabled",r.formGroup.invalid))},dependencies:[E,k,F,U,$,j,D,I],styles:["[_nghost-%COMP%]   .register[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px}[_nghost-%COMP%]   .register[_ngcontent-%COMP%] > form[_ngcontent-%COMP%], [_nghost-%COMP%]   .register[_ngcontent-%COMP%] > article[_ngcontent-%COMP%]{padding:16px;border-radius:16px;width:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .register[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]{gap:16px;background:var(--theme-surface);border:1px solid var(--color-outline)}[_nghost-%COMP%]   .register[_ngcontent-%COMP%] > article[_ngcontent-%COMP%]{gap:8px}@media screen and (min-width: 768px){[_nghost-%COMP%]   .register[_ngcontent-%COMP%] > form[_ngcontent-%COMP%], [_nghost-%COMP%]   .register[_ngcontent-%COMP%] > article[_ngcontent-%COMP%]{width:400px}[_nghost-%COMP%]   .register[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]{gap:8px}}@media screen and (min-width: 1024px){[_nghost-%COMP%]   .register[_ngcontent-%COMP%] > form[_ngcontent-%COMP%], [_nghost-%COMP%]   .register[_ngcontent-%COMP%] > article[_ngcontent-%COMP%]{width:700px}}"]})};export{T as RegisterComponent};
