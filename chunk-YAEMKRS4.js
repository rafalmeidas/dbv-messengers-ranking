import{a as E,c as C,d as P,f as W}from"./chunk-PZYF3V45.js";import{a as L,b as k,c as B,d as I,e as $,f as q,g as x,h as G}from"./chunk-KVQJGPWT.js";import{G as A,I as g}from"./chunk-EYG3RGZS.js";import{$ as u,$a as S,Ba as c,Ja as U,Q as F,Sa as T,Ua as n,V as N,Va as a,Xa as j,Ya as v,Za as D,_ as w,_a as d,ab as y,bb as _,f as l,ha as m,ia as p,m as R,t as M,u as b,y as V}from"./chunk-OOT4PRE5.js";var f=class s{constructor(e,t){this.firestore=e;this.authService=t}role$=new R(null);setUserRole(e,t){return l(this,null,function*(){let r=C(this.firestore,`users/${t}`);yield W(r,{role:e},{merge:!0}),this.role$.next(e)})}getUserRole$(){return this.role$.pipe(F(e=>e?b(e):M(this.loadUserRole())))}loadUserRole(){return l(this,null,function*(){let e=yield V(this.authService.currentUser);if(!e)return"user";let t=C(this.firestore,`users/${e.uid}`),i=(yield P(t)).data()?.role??"user";return this.role$.next(i),i})}resetRole(){this.role$.next(null)}static \u0275fac=function(t){return new(t||s)(w(E),w(g))};static \u0275prov=N({token:s,factory:s.\u0275fac,providedIn:"root"})};var z=class s{email="";password="";authService=u(g);userService=u(f);router=u(A);register(){return l(this,null,function*(){let e=yield this.authService.register(this.email,this.password);e&&(yield this.userService.setUserRole("user",e.user.uid),this.router.navigateByUrl("/home"))})}navigateToLogin(){this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||s)};static \u0275cmp=U({type:s,selectors:[["app-register"]],decls:10,vars:3,consts:[["registerForm","ngForm"],[3,"ngSubmit"],["type","email","name","email","placeholder","Email","required","",3,"ngModelChange","ngModel"],["type","password","name","password","placeholder","Password","required","",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],[3,"click"]],template:function(t,r){if(t&1){let i=j();n(0,"h2"),d(1,"Register"),a(),n(2,"form",1,0),v("ngSubmit",function(){return m(i),p(r.register())}),n(4,"input",2),_("ngModelChange",function(o){return m(i),y(r.email,o)||(r.email=o),p(o)}),a(),n(5,"input",3),_("ngModelChange",function(o){return m(i),y(r.password,o)||(r.password=o),p(o)}),a(),n(6,"button",4),d(7,"Register"),a()(),n(8,"button",5),v("click",function(){return m(i),p(r.navigateToLogin())}),d(9,"Login"),a()}if(t&2){let i=D(3);c(4),S("ngModel",r.email),c(),S("ngModel",r.password),c(),T("disabled",i.invalid)}},dependencies:[G,q,L,k,B,x,$,I],encapsulation:2})};export{z as RegisterComponent};
