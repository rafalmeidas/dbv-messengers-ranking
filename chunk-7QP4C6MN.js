import{c as Y}from"./chunk-AXK5T5EB.js";import{a as Z}from"./chunk-IFAMMSVR.js";import{d as L,f as $,g as _,h as B,i as M,j as d,n as Q}from"./chunk-KKRSEMEC.js";import{b as f,d as G,e as U,g as w,i as z,j as H,k as J,l as K,q as W,s as X}from"./chunk-RNFB6XQL.js";import{a as R}from"./chunk-ZC6LOVEO.js";import{R as j,T as A,c as T,d as k,f as V}from"./chunk-KGZEMMMY.js";import{Ha as o,Ra as C,Va as P,W as I,a as O,aa as s,ab as a,b as F,db as r,eb as u,f as x,fb as l,gb as N,hb as v,ia as E,ib as S,ja as D,ob as c,pb as h}from"./chunk-ZOQ26LPS.js";var m=class i{firestore=s(L);getAllQuestionnaires(){let t=M(this.firestore,"questionnaires");return $(t,{idField:"id"})}getQuestionnaireById(t){let e=d(this.firestore,`questionnaires/${t}`);return _(e)}createQuestionnaire(t){let e=M(this.firestore,"questionnaires"),n=F(O({},t),{questions:t.questions||[]});return B(e,n)}updateQuestionnaire(t,e){let n=d(this.firestore,`questionnaires/${t}`);return Q(n,e)}addQuestion(t,e){return x(this,null,function*(){let n=d(this.firestore,`questionnaires/${t}`),y=[...(yield _(n).toPromise()).questions||[],e];return Q(n,{questions:y})})}removeQuestion(t,e){return x(this,null,function*(){let n=d(this.firestore,`questionnaires/${t}`),y=((yield _(n).toPromise()).questions||[]).filter((re,te)=>te!==e);return Q(n,{questions:y})})}static \u0275fac=function(e){return new(e||i)};static \u0275prov=I({token:i,factory:i.\u0275fac,providedIn:"root"})};var q=class i{_questionService=s(m);questionnaires=[];constructor(){this._questionService.getAllQuestionnaires().subscribe(t=>this.questionnaires=t)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=C({type:i,selectors:[["app-question-list"]],decls:1,vars:1,consts:[["title","Perguntas","btnNewUrl","/question/create","btnEditUrl","/question/edit",3,"listArray"]],template:function(e,n){e&1&&l(0,"app-list",0),e&2&&a("listArray",n.questionnaires)},dependencies:[Z],encapsulation:2})};function ie(i,t){if(i&1){let e=N();r(0,"li")(1,"span"),c(2),u(),r(3,"span"),c(4),u(),r(5,"app-button",10),v("onClick",function(){let p=E(e).index,b=S(2);return D(b.removeQuestion(p))}),u()()}if(i&2){let e=t.$implicit;o(2),h(e.text),o(2),h(e.points)}}function oe(i,t){if(i&1&&(r(0,"div",8)(1,"h3"),c(2,"Perguntas adicionadas:"),u(),r(3,"ul"),P(4,ie,6,2,"li",9),u()()),i&2){let e=S();o(4),a("ngForOf",e.questions)}}var g=class i{_fb=s(W);_questionService=s(m);_route=s(j);_router=s(A);form=this._fb.group({name:["",f.required]});newQuestionControl=new w("",f.required);newPointsControl=new w(0,[f.required,f.min(0)]);isEditMode=!1;questionnaireId=null;questions=[];constructor(){this._route.paramMap.subscribe(t=>{this.questionnaireId=t.get("id"),this.isEditMode=!!this.questionnaireId,this.questionnaireId&&this._questionService.getQuestionnaireById(this.questionnaireId).subscribe(e=>{e&&(this.form.get("name")?.patchValue(e.name),this.questions=e.questions)})})}addQuestion(){if(this.newQuestionControl.valid&&this.newPointsControl.valid){let t={text:this.newQuestionControl.value??"",points:this.newPointsControl.value??0};this.questions.push(t),this.newQuestionControl.reset(),this.newPointsControl.setValue(0)}}removeQuestion(t){this.questions.splice(t,1)}onSubmit(){if(this.form.valid){let t={name:this.form.value.name??"",questions:this.questions};this._questionService.createQuestionnaire(t).then(()=>{this.form.reset(),this.questions=[]})}}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=C({type:i,selectors:[["app-question-form"]],decls:10,vars:6,consts:[[1,"space-y-4",3,"ngSubmit","formGroup"],["label","Nome do Question\xE1rio","formControlName","name","name","name","placeholder","Digite o nome"],[1,"container"],["label","Pergunta","name","name","placeholder","Digite a Pergunta",3,"formControl"],["label","Pontos","name","name","placeholder","Digite os pontos","type","number","min","0",3,"formControl"],["type","button","label","Adicionar",3,"onClick"],["class","container-list",4,"ngIf"],["type","submit","label","Salvar",3,"disabled"],[1,"container-list"],[4,"ngFor","ngForOf"],["variant","icon","icon","delete",3,"onClick"]],template:function(e,n){e&1&&(r(0,"h1"),c(1),u(),r(2,"form",0),v("ngSubmit",function(){return n.onSubmit()}),l(3,"app-input",1),r(4,"div",2),l(5,"app-input",3)(6,"app-input",4),r(7,"app-button",5),v("onClick",function(){return n.addQuestion()}),u()(),P(8,oe,5,1,"div",6),l(9,"app-button",7),u()),e&2&&(o(),h(n.isEditMode?"Editar question\xE1rio":"Criar question\xE1rio"),o(),a("formGroup",n.form),o(3),a("formControl",n.newQuestionControl),o(),a("formControl",n.newPointsControl),o(2),a("ngIf",n.questions.length>0),o(),a("disabled",n.form.invalid))},dependencies:[X,z,G,U,H,J,K,V,T,k,Y,R],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:8px}[_nghost-%COMP%] > h1[_ngcontent-%COMP%]{color:var(--color-text-high)}[_nghost-%COMP%] > form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding:16px;border:1px solid var(--color-outline-variant);border-radius:16px}[_nghost-%COMP%]   .container-list[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--color-text-high)}[_nghost-%COMP%]   .container-list[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%]{width:100%;margin-top:16px;list-style:none;display:flex;padding:16px;border:1px solid var(--color-outline-variant);border-radius:8px}[_nghost-%COMP%]   .container-list[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:space-between;color:var(--color-text-low)}"]})};var we=[{path:"",component:q},{path:"create",component:g},{path:"edit/:id",component:g}];export{we as ROUTES};
